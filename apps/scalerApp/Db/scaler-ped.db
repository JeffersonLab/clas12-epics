
#######################################
# testing only:
record(ai,"$(OUT)") {}
record(ai,"$(REF)") {
    field(PINI,"1")
    field(VAL,"99999")
}
#record(ai,"$(RAW)") {}
#######################################

record(compress,"$(P)$(R=)_bpm_circbuff") {
    field(SCAN,"1 second")
    field(INP,"$(REF)")
    field(ALG,"Circular Buffer")
    field(NSAM,"9")
    field(N,"9")
    field(FLNK,"$(P)$(R=)_raw_circbuff.PROC")
}
record(compress,"$(P)$(R=)_raw_circbuff") {
    field(INP,"$(RAW)")
    field(ALG,"Circular Buffer")
    field(NSAM,"5")
    field(N,"5")
    field(FLNK,"$(P)$(R=)_bpm_circbuff2.PROC")
}
record(compress,"$(P)$(R=)_bpm_circbuff2") {
    field(INP,"$(REF)")
    field(ALG,"Circular Buffer")
    field(NSAM,"4")
    field(N,"4")
    field(FLNK,"$(P)$(R=)_4bpm_avg.PROC")
}
record(compress,"$(P)$(R=)_4bpm_avg") {
    field(INP,"$(P)$(R=)_bpm_circbuff")
    field(ALG,"N to 1 Average")
    field(NSAM,"1")
    field(N,"4")
    field(FLNK,"$(P)$(R=)_raw.PROC")
}
record(compress,"$(P)$(R=)_raw") {
    field(INP,"$(P)$(R=)_raw_circbuff")
    field(ALG,"N to 1 Average")
    field(NSAM,"1")
    field(N,"1")
    field(FLNK,"$(P)$(R=)_4bpm_avg2.PROC")
}
record(compress,"$(P)$(R=)_4bpm_avg2") {
    field(INP,"$(P)$(R=)_bpm_circbuff2")
    field(ALG,"N to 1 Average")
    field(NSAM,"1")
    field(N,"4")
    field(FLNK,"$(P)$(R=)_calcout.PROC")
}
record(calcout,"$(P)$(R=)_calcout") {
    field(INPA,"$(RAW)")
    field(INPB,"$(REF)")
    field(INPC,"$(REFMAX)")
    field(INPD,"$(RAWMAX=300)")
    field(INPE,"$(P)$(R=)_4bpm_avg")
    field(INPF,"$(P)$(R=)_4bpm_avg2")
    field(INPG,"$(P)$(R=)_raw")
    field(CALC,"( B<C && E<C && F<C && (D<=0 || A<D) ) ? 1 : 0")
    field(OOPT,"When Non-zero")
    field(OCAL,"1")
    field(DOPT,"Use OCAL")
    field(OUT,"$(P)$(R=)_circbuff.PROC PP")
}
record(compress,"$(P)$(R=)_circbuff") {
    field(INP,"$(P)$(R=)_raw")
    field(ALG,"Circular Buffer")
    field(NSAM,"$(N)")
    field(N,"$(N)")
    field(FLNK,"$(P)$(R=)_average.PROC PP")
}
record(compress,"$(P)$(R=)_average") {
    field(INP,"$(P)$(R=)_circbuff")
    field(ALG,"N to 1 Average")
    field(NSAM,"1")
    field(N,"$(N)")
    field(FLNK,"$(P)$(R=)_write PP")
    info(autosaveFields_pass0,"VAL")
}
record(seq,"$(P)$(R=)_write") {
    field(DISV,0)
    field(SDIS,"$(P)$(R=)_enable.VAL")
    field(DOL1,"$(P)$(R=)_average")
    field(LNK1,"$(OUT) PP")
    field(DOL2,"1")
    field(LNK2,"$(P)$(R=)_changed PP")
}
record(bo,"$(P)$(R=)_changed") {
    field(ZNAM,"Idle")
    field(ONAM,"Active")
    field(VAL,"0")
    field(PINI,"0")
    field(HIGH,"0.5")
}
record(bi,"$(P)$(R=)_enable") {
    field(ZNAM,"Disabled")
    field(ONAM,"Enabled")
    field(VAL,"0")
}


