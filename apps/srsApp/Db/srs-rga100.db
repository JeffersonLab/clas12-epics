
record(longin, "$(P)$(R=)Reset") {
  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@srsrga.proto reset $(PORT)")
  field(FLNK, "$(P)$(R=)PPS PP")
  field(PINI, "YES")
}

record(longin, "$(P)$(R=)AScan_Pts") {
  field(DESC, "Analog scan points")
#??  field(SCAN, "Passive")
  field(DTYP, "stream")
  field(INP, "@srsrga.proto ap_rdbk $(PORT)")
  field(SCAN, "2 second")
}

record(calc, "$(P)$(R=)AScan_Bytes") {
#  field(SCAN, "2 second")
  field(INPA, "$(P)$(R=)AScan_Pts PP")
  field(CALC, "A*4+1")
  field(FLNK, "$(P)$(R=)PPS PP")
}

record(ai, "$(P)$(R=)PPS") {
  field(DESC, "Partial Pressure Sensitivity")
#  field(SCAN, "5 second")
  field(DTYP, "stream")
  field(INP, "@srsrga.proto sp_rdbk $(PORT)")
  field(PREC, "3")
  field(EGU, "mA/Torr")
}

record(calc, "$(P)$(R=)FactSens") {
  field(DESC, "Factor sensitivity")
  field(SCAN, "Passive")
  field(INPA, "$(P)$(R=)PPS CP")
  field(INPB, "1.0e-16")
  field(CALC, "A?B*1000/A:0")
}

record(waveform, "$(P)$(R=)AScan_Single") {
  field(DESC, "1 single analog scan")
  field(FTVL, "LONG")
  field(NELM, "2000")
#  field(SCAN, "10 second")
  field(DTYP, "stream")
  field(INP, "@srsrga.proto ascan_1($(SC)) $(PORT)")
  field(FLNK, "$(P)$(R=)Num")
  field(TPRO, 1)
}

record(calc, "$(P)$(R=)Num") {
  field(SCAN, "Passive")
  field(INPA, "$(P)$(R=)AScan_Single.NORD NPP")
  field(CALC, "A")
  field(FLNK, "$(P)$(R=)UpdateCount.PROC")
  field(VAL, "0")
}

record(calc, "$(P)$(R=)UpdateCount") {
  field(SCAN, "Passive")
  field(INPA, "$(P)$(R=)UpdateCount NPP")
  field(CALC, "A+1")
  field(VAL, "0")
  field(FLNK, "$(P)$(R=)PP_Mass")
}

record(acalcout, "$(P)$(R=)PP_Mass") {
  field(DESC, "Partial pressure Mass")
  field(NELM, "2000")
  field(INPA, "$(P)$(R=)PPS PP")
  field(INAA, "$(P)$(R=)AScan_Single PP")
  field(CALC, "(AA*1.0e-13)/A") # PPS is mA/Torr -> 1e-13
  field(PREC, "12")
  field(EGU, "Torr")
  field(FLNK, "$(P)$(R=)PP_Scan")
}

record(compress, "$(P)$(R=)PP_Scan") {
  field(DESC, "Single Scan PP-Line")
  field(ALG,  "N to 1 Median")
  field(N, "$(SC)")
  field(NSAM, "64")
  field(INP,  "$(P)$(R=)PP_Mass.AVAL")
  field(PREC, "12")
}

record(ao, "$(P)$(R=)Mass_MNO") {
  field(VAL, "02")
  field(TPRO, 1)
}

record(longout, "$(P)$(R=)NF"){
  field(DTYP,"stream")
  field(OUT,"@srsrga.proto nf $(PORT)")
  field(FLNK,"$(P)$(R=)NF:RBV")
}
record(longin, "$(P)$(R=)NF:RBV"){
  field(DTYP,"stream")
  field(PINI,"YES")
  field(INP,"@srsrga.proto nf_rdbk $(PORT)")
}

record(longin, "$(P)$(R=)Mass_MN") {
#  field(SCAN, "5 second")
  field(DTYP, "stream")
  field(INP, "@srsrga.proto m_meas($(P)$(R=)Mass_MNO) $(PORT) ")
  field(FLNK, "$(P)$(R=)PartPN PP")
  field(VAL, "02")
  field(TPRO, 1)
}

record(calc, "$(P)$(R=)PartPN") {
#  field(SCAN, "5 second")
  field(INPA, "$(P)$(R=)PPS")
  field(INPB, "$(P)$(R=)Mass_MN")
  field(CALC, "A?(B*1e-13)/A:0")
  field(PREC, "12")
  field(EGU, "Torr")
  field(FLNK, "$(P)$(R=)Histo_PartPN PP")
  field(TPRO, 1)
}

record(compress, "$(P)$(R=)Histo_PartPN") {
  field(DESC, "Pressure Buf")
#  field(SCAN, "5 second")
  field(ALG,  "Circular Buffer")
  field(NSAM, "2000")
  field(INP,  "$(P)$(R=)PartPN ")
  field(PREC, "12")
  field(TPRO, 1)
}

record(ai, "$(P)$(R=)FL") {
  field(DESC, "Filament -Electron emission I")
  field(SCAN, "5 second")
  field(DTYP, "stream")
  field(INP, "@srsrga.proto fl_rdbk $(PORT)")
  field(PREC, "3")
}

record(ao, "$(P)$(R=)FLSet") {
  field(DESC, "Set Filament current")
  field(DTYP, "stream")
  field(OUT, "@srsrga.proto fl $(PORT)")
  field(HOPR, "1.0")
  field(LOPR, "0.0")
  field(DRVH, "1.0")
  field(DRVL, "0.0")
  field(VAL, "0")
  field(FLNK, "$(P)$(R=)FL PP")
}

record(calc, "$(P)$(R=)Scan") {
#  field(INPA, "$(P)$(R=)FL CPP")
  field(CALC, "A=0?0:4")
  field(FLNK, "$(P)$(R=)fout1")
  field(TPRO, 1)
}

record(dfanout, "$(P)$(R=)fout1") {
  field(DOL, "$(P)$(R=)Scan")
  field(OMSL, "closed_loop")
  field(OUTA, "$(P)$(R=)Mass_M2.SCAN PP") 
  field(OUTB, "$(P)$(R=)Mass_M12.SCAN PP") 
  field(OUTC, "$(P)$(R=)Mass_M14.SCAN PP") 
  field(OUTD, "$(P)$(R=)Mass_M15.SCAN PP") 
  field(OUTE, "$(P)$(R=)Mass_M16.SCAN PP") 
  field(OUTF, "$(P)$(R=)Mass_M17.SCAN PP") 
  field(OUTG, "$(P)$(R=)Mass_M18.SCAN PP") 
  field(OUTH, "$(P)$(R=)Mass_M26.SCAN PP") 
  field(FLNK, "$(P)$(R=)fout2")
  field(TPRO, 1)
}

record(dfanout, "$(P)$(R=)fout2") {
  field(DOL, "$(P)$(R=)Scan")
  field(OMSL, "closed_loop")
  field(OUTA, "$(P)$(R=)Mass_M28.SCAN PP") 
  field(OUTB, "$(P)$(R=)Mass_M29.SCAN PP") 
  field(OUTC, "$(P)$(R=)Mass_M32.SCAN PP") 
  field(OUTD, "$(P)$(R=)Mass_M40.SCAN PP") 
  field(OUTE, "$(P)$(R=)Mass_M41.SCAN PP") 
  field(OUTF, "$(P)$(R=)Mass_M44.SCAN PP") 
  field(OUTG, "$(P)$(R=)Mass_M69.SCAN PP") 
  field(TPRO, 1)
}
